{"remainingRequest":"D:\\work\\dlksc\\node_modules\\babel-loader\\lib\\index.js!D:\\work\\dlksc\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\work\\dlksc\\src\\permission.js","dependencies":[{"path":"D:\\work\\dlksc\\src\\permission.js","mtime":1765263860728},{"path":"D:\\work\\dlksc\\babel.config.js","mtime":1741570206490},{"path":"D:\\work\\dlksc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741571479562},{"path":"D:\\work\\dlksc\\node_modules\\babel-loader\\lib\\index.js","mtime":1741571480837},{"path":"D:\\work\\dlksc\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1741571479931}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovd29yay9kbGtzYy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMi5qcyI7CmltcG9ydCByb3V0ZXIgZnJvbSAiLi9yb3V0ZXIiOwppbXBvcnQgc3RvcmUgZnJvbSAiLi9zdG9yZSI7CmltcG9ydCB7IE1lc3NhZ2UgfSBmcm9tICJlbGVtZW50LXVpIjsKaW1wb3J0IE5Qcm9ncmVzcyBmcm9tICJucHJvZ3Jlc3MiOwppbXBvcnQgIm5wcm9ncmVzcy9ucHJvZ3Jlc3MuY3NzIjsKaW1wb3J0IHsgZ2V0VG9rZW4gfSBmcm9tICJAL3V0aWxzL2F1dGgiOwpOUHJvZ3Jlc3MuY29uZmlndXJlKHsKICBzaG93U3Bpbm5lcjogZmFsc2UKfSk7CnZhciB3aGl0ZUxpc3QgPSBbIi9sb2dpbiIsICIvZGxrc2MvaW5kZXgiLCAiL2Rsa3NjL3hxIiwgIi9kbGtzYy9nZHRqIiwgIi9kbGtzYy95Y3NqIiwgIi9kbGtzYy9hYm5vcm1hbCIsICIvZGxrc2MvY2hhcnQiLCAiL2Rsa3NjL3hzZngiLCAiL2Rsa3NjL3hzc2pxZCJdOwpyb3V0ZXIuYmVmb3JlRWFjaChmdW5jdGlvbiAodG8sIGZyb20sIG5leHQpIHsKICBOUHJvZ3Jlc3Muc3RhcnQoKTsKCiAgaWYgKHdoaXRlTGlzdC5pbmRleE9mKHRvLnBhdGgpICE9PSAtMSkgewogICAgLy8g5Zyo5YWN55m75b2V55m95ZCN5Y2V77yM55u05o6l6L+b5YWlCiAgICBuZXh0KCk7CiAgfSBlbHNlIGlmIChnZXRUb2tlbigpKSB7CiAgICBpZiAoc3RvcmUuZ2V0dGVycy5yb2xlcy5sZW5ndGggPT09IDApIHsKICAgICAgLy8g5Yik5pat5b2T5YmN55So5oi35piv5ZCm5bey5ouJ5Y+W5a6MdXNlcl9pbmZv5L+h5oGvCiAgICAgIHN0b3JlLmRpc3BhdGNoKCJHZXRJbmZvIikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgc3RvcmUuZGlzcGF0Y2goIkdlbmVyYXRlUm91dGVzIikudGhlbihmdW5jdGlvbiAoYWNjZXNzUm91dGVzKSB7CiAgICAgICAgICAvLyDmoLnmja5yb2xlc+adg+mZkOeUn+aIkOWPr+iuv+mXrueahOi3r+eUseihqAogICAgICAgICAgcm91dGVyLmFkZFJvdXRlcyhhY2Nlc3NSb3V0ZXMpOyAvLyDliqjmgIHmt7vliqDlj6/orr/pl67ot6/nlLHooagKCiAgICAgICAgICBuZXh0KF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdG8pLCB7fSwgewogICAgICAgICAgICByZXBsYWNlOiB0cnVlCiAgICAgICAgICB9KSk7IC8vIGhhY2vmlrnms5Ug56Gu5L+dYWRkUm91dGVz5bey5a6M5oiQCiAgICAgICAgfSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICBzdG9yZS5kaXNwYXRjaCgiTG9nT3V0IikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBNZXNzYWdlLmVycm9yKGVycik7CiAgICAgICAgICBuZXh0KHsKICAgICAgICAgICAgcGF0aDogIi9sb2dpbiIKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIG5leHQoKTsKICAgIH0KICB9IGVsc2UgewogICAgbmV4dCgiL2xvZ2luIik7IC8vIOWQpuWImeWFqOmDqOmHjeWumuWQkeWIsOmmlumhtQogICAgLy8gbmV4dCgnL2Rsa2N3L2luZGV4JykgLy8g5ZCm5YiZ5YWo6YOo6YeN5a6a5ZCR5Yiw6aaW6aG1CiAgfQp9KTsKcm91dGVyLmFmdGVyRWFjaChmdW5jdGlvbiAoKSB7CiAgTlByb2dyZXNzLmRvbmUoKTsKfSk7"},{"version":3,"sources":["D:/work/dlksc/src/permission.js"],"names":["router","store","Message","NProgress","getToken","configure","showSpinner","whiteList","beforeEach","to","from","next","start","indexOf","path","getters","roles","length","dispatch","then","accessRoutes","addRoutes","replace","catch","err","error","afterEach","done"],"mappings":";AAAA,OAAOA,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,SAASC,OAAT,QAAwB,YAAxB;AACA,OAAOC,SAAP,MAAsB,WAAtB;AACA,OAAO,yBAAP;AACA,SAASC,QAAT,QAAyB,cAAzB;AAEAD,SAAS,CAACE,SAAV,CAAoB;AAAEC,EAAAA,WAAW,EAAE;AAAf,CAApB;AAEA,IAAMC,SAAS,GAAG,CAChB,QADgB,EAEhB,cAFgB,EAGhB,WAHgB,EAIhB,aAJgB,EAKhB,aALgB,EAMhB,iBANgB,EAOhB,cAPgB,EAQhB,aARgB,EASf,eATe,CAAlB;AAYAP,MAAM,CAACQ,UAAP,CAAkB,UAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAoB;AACpCR,EAAAA,SAAS,CAACS,KAAV;;AACA,MAAIL,SAAS,CAACM,OAAV,CAAkBJ,EAAE,CAACK,IAArB,MAA+B,CAAC,CAApC,EAAuC;AACrC;AACAH,IAAAA,IAAI;AACL,GAHD,MAGO,IAAIP,QAAQ,EAAZ,EAAgB;AACrB,QAAIH,KAAK,CAACc,OAAN,CAAcC,KAAd,CAAoBC,MAApB,KAA+B,CAAnC,EAAsC;AACpC;AACAhB,MAAAA,KAAK,CACFiB,QADH,CACY,SADZ,EAEGC,IAFH,CAEQ,YAAM;AACVlB,QAAAA,KAAK,CAACiB,QAAN,CAAe,gBAAf,EAAiCC,IAAjC,CAAsC,UAACC,YAAD,EAAkB;AACtD;AACApB,UAAAA,MAAM,CAACqB,SAAP,CAAiBD,YAAjB,EAFsD,CAEtB;;AAChCT,UAAAA,IAAI,iCAAMF,EAAN;AAAUa,YAAAA,OAAO,EAAE;AAAnB,aAAJ,CAHsD,CAGtB;AACjC,SAJD;AAKD,OARH,EASGC,KATH,CASS,UAACC,GAAD,EAAS;AACdvB,QAAAA,KAAK,CAACiB,QAAN,CAAe,QAAf,EAAyBC,IAAzB,CAA8B,YAAM;AAClCjB,UAAAA,OAAO,CAACuB,KAAR,CAAcD,GAAd;AACAb,UAAAA,IAAI,CAAC;AAAEG,YAAAA,IAAI,EAAE;AAAR,WAAD,CAAJ;AACD,SAHD;AAID,OAdH;AAeD,KAjBD,MAiBO;AACLH,MAAAA,IAAI;AACL;AACF,GArBM,MAqBA;AACLA,IAAAA,IAAI,CAAC,QAAD,CAAJ,CADK,CACW;AAChB;AACD;AACF,CA9BD;AAgCAX,MAAM,CAAC0B,SAAP,CAAiB,YAAM;AACrBvB,EAAAA,SAAS,CAACwB,IAAV;AACD,CAFD","sourcesContent":["import router from \"./router\";\nimport store from \"./store\";\nimport { Message } from \"element-ui\";\nimport NProgress from \"nprogress\";\nimport \"nprogress/nprogress.css\";\nimport { getToken } from \"@/utils/auth\";\n\nNProgress.configure({ showSpinner: false });\n\nconst whiteList = [\n  \"/login\",\n  \"/dlksc/index\",\n  \"/dlksc/xq\",\n  \"/dlksc/gdtj\",\n  \"/dlksc/ycsj\",\n  \"/dlksc/abnormal\",\n  \"/dlksc/chart\",\n  \"/dlksc/xsfx\",\n   \"/dlksc/xssjqd\",\n];\n\nrouter.beforeEach((to, from, next) => {\n  NProgress.start();\n  if (whiteList.indexOf(to.path) !== -1) {\n    // 在免登录白名单，直接进入\n    next();\n  } else if (getToken()) {\n    if (store.getters.roles.length === 0) {\n      // 判断当前用户是否已拉取完user_info信息\n      store\n        .dispatch(\"GetInfo\")\n        .then(() => {\n          store.dispatch(\"GenerateRoutes\").then((accessRoutes) => {\n            // 根据roles权限生成可访问的路由表\n            router.addRoutes(accessRoutes); // 动态添加可访问路由表\n            next({ ...to, replace: true }); // hack方法 确保addRoutes已完成\n          });\n        })\n        .catch((err) => {\n          store.dispatch(\"LogOut\").then(() => {\n            Message.error(err);\n            next({ path: \"/login\" });\n          });\n        });\n    } else {\n      next();\n    }\n  } else {\n    next(\"/login\"); // 否则全部重定向到首页\n    // next('/dlkcw/index') // 否则全部重定向到首页\n  }\n});\n\nrouter.afterEach(() => {\n  NProgress.done();\n});\n"]}]}