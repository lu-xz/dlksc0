{"remainingRequest":"D:\\work\\dlksc\\node_modules\\babel-loader\\lib\\index.js!D:\\work\\dlksc\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\work\\dlksc\\src\\utils\\dict\\Dict.js","dependencies":[{"path":"D:\\work\\dlksc\\src\\utils\\dict\\Dict.js","mtime":1741570207546},{"path":"D:\\work\\dlksc\\babel.config.js","mtime":1741570206490},{"path":"D:\\work\\dlksc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741571479562},{"path":"D:\\work\\dlksc\\node_modules\\babel-loader\\lib\\index.js","mtime":1741571480837},{"path":"D:\\work\\dlksc\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1741571479931}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJEOi93b3JrL2Rsa3NjL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheS5qcyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiRDovd29yay9kbGtzYy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2suanMiOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkQ6L3dvcmsvZGxrc2Mvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci5tYXgtc2FmZS1pbnRlZ2VyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgeyBtZXJnZVJlY3Vyc2l2ZSB9IGZyb20gIkAvdXRpbHMvcnVveWkiOwppbXBvcnQgRGljdE1ldGEgZnJvbSAnLi9EaWN0TWV0YSc7CmltcG9ydCBEaWN0RGF0YSBmcm9tICcuL0RpY3REYXRhJzsKdmFyIERFRkFVTFRfRElDVF9PUFRJT05TID0gewogIHR5cGVzOiBbXQp9OwovKioKICogQGNsYXNzZGVzYyDlrZflhbgKICogQHByb3BlcnR5IHtPYmplY3R9IGxhYmVsIOagh+etvuWvueixoe+8jOWGhemDqOWxnuaAp+WQjeS4uuWtl+WFuOexu+Wei+WQjeensAogKiBAcHJvcGVydHkge09iamVjdH0gZGljdCDlrZfmrrXmlbDnu4TvvIzlhoXpg6jlsZ7mgKflkI3kuLrlrZflhbjnsbvlnovlkI3np7AKICogQHByb3BlcnR5IHtBcnJheS48RGljdE1ldGE+fSBfZGljdE1ldGFzIOWtl+WFuOWFg+aVsOaNruaVsOe7hAogKi8KCnZhciBEaWN0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBEaWN0KCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERpY3QpOwoKICAgIHRoaXMub3duZXIgPSBudWxsOwogICAgdGhpcy5sYWJlbCA9IHt9OwogICAgdGhpcy50eXBlID0ge307CiAgfQoKICBfY3JlYXRlQ2xhc3MoRGljdCwgW3sKICAgIGtleTogImluaXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQob3B0aW9ucykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKG9wdGlvbnMgaW5zdGFuY2VvZiBBcnJheSkgewogICAgICAgIG9wdGlvbnMgPSB7CiAgICAgICAgICB0eXBlczogb3B0aW9ucwogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHZhciBvcHRzID0gbWVyZ2VSZWN1cnNpdmUoREVGQVVMVF9ESUNUX09QVElPTlMsIG9wdGlvbnMpOwoKICAgICAgaWYgKG9wdHMudHlwZXMgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignbmVlZCBkaWN0IHR5cGVzJyk7CiAgICAgIH0KCiAgICAgIHZhciBwcyA9IFtdOwogICAgICB0aGlzLl9kaWN0TWV0YXMgPSBvcHRzLnR5cGVzLm1hcChmdW5jdGlvbiAodCkgewogICAgICAgIHJldHVybiBEaWN0TWV0YS5wYXJzZSh0KTsKICAgICAgfSk7CgogICAgICB0aGlzLl9kaWN0TWV0YXMuZm9yRWFjaChmdW5jdGlvbiAoZGljdE1ldGEpIHsKICAgICAgICB2YXIgdHlwZSA9IGRpY3RNZXRhLnR5cGU7CiAgICAgICAgVnVlLnNldChfdGhpcy5sYWJlbCwgdHlwZSwge30pOwogICAgICAgIFZ1ZS5zZXQoX3RoaXMudHlwZSwgdHlwZSwgW10pOwoKICAgICAgICBpZiAoZGljdE1ldGEubGF6eSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgcHMucHVzaChsb2FkRGljdChfdGhpcywgZGljdE1ldGEpKTsKICAgICAgfSk7CgogICAgICByZXR1cm4gUHJvbWlzZS5hbGwocHMpOwogICAgfQogICAgLyoqCiAgICAgKiDph43mlrDliqDovb3lrZflhbgKICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIOWtl+WFuOexu+WeiwogICAgICovCgogIH0sIHsKICAgIGtleTogInJlbG9hZERpY3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbG9hZERpY3QodHlwZSkgewogICAgICB2YXIgZGljdE1ldGEgPSB0aGlzLl9kaWN0TWV0YXMuZmluZChmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlLnR5cGUgPT09IHR5cGU7CiAgICAgIH0pOwoKICAgICAgaWYgKGRpY3RNZXRhID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoInRoZSBkaWN0IG1ldGEgb2YgIi5jb25jYXQodHlwZSwgIiB3YXMgbm90IGZvdW5kIikpOwogICAgICB9CgogICAgICByZXR1cm4gbG9hZERpY3QodGhpcywgZGljdE1ldGEpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIERpY3Q7Cn0oKTsKLyoqCiAqIOWKoOi9veWtl+WFuAogKiBAcGFyYW0ge0RpY3R9IGRpY3Qg5a2X5YW4CiAqIEBwYXJhbSB7RGljdE1ldGF9IGRpY3RNZXRhIOWtl+WFuOWFg+aVsOaNrgogKiBAcmV0dXJucyB7UHJvbWlzZX0KICovCgoKZXhwb3J0IHsgRGljdCBhcyBkZWZhdWx0IH07CgpmdW5jdGlvbiBsb2FkRGljdChkaWN0LCBkaWN0TWV0YSkgewogIHJldHVybiBkaWN0TWV0YS5yZXF1ZXN0KGRpY3RNZXRhKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgdmFyIF9kaWN0JHR5cGUkdHlwZTsKCiAgICB2YXIgdHlwZSA9IGRpY3RNZXRhLnR5cGU7CiAgICB2YXIgZGljdHMgPSBkaWN0TWV0YS5yZXNwb25zZUNvbnZlcnRlcihyZXNwb25zZSwgZGljdE1ldGEpOwoKICAgIGlmICghKGRpY3RzIGluc3RhbmNlb2YgQXJyYXkpKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoJ3RoZSByZXR1cm4gb2YgcmVzcG9uc2VDb252ZXJ0ZXIgbXVzdCBiZSBBcnJheS48RGljdERhdGE+Jyk7CiAgICAgIGRpY3RzID0gW107CiAgICB9IGVsc2UgaWYgKGRpY3RzLmZpbHRlcihmdW5jdGlvbiAoZCkgewogICAgICByZXR1cm4gZCBpbnN0YW5jZW9mIERpY3REYXRhOwogICAgfSkubGVuZ3RoICE9PSBkaWN0cy5sZW5ndGgpIHsKICAgICAgY29uc29sZS5lcnJvcigndGhlIHR5cGUgb2YgZWxlbWVudHMgaW4gZGljdHMgbXVzdCBiZSBEaWN0RGF0YScpOwogICAgICBkaWN0cyA9IFtdOwogICAgfQoKICAgIChfZGljdCR0eXBlJHR5cGUgPSBkaWN0LnR5cGVbdHlwZV0pLnNwbGljZS5hcHBseShfZGljdCR0eXBlJHR5cGUsIFswLCBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUl0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShkaWN0cykpKTsKCiAgICBkaWN0cy5mb3JFYWNoKGZ1bmN0aW9uIChkKSB7CiAgICAgIFZ1ZS5zZXQoZGljdC5sYWJlbFt0eXBlXSwgZC52YWx1ZSwgZC5sYWJlbCk7CiAgICB9KTsKICAgIHJldHVybiBkaWN0czsKICB9KTsKfQ=="},{"version":3,"sources":["D:/work/dlksc/src/utils/dict/Dict.js"],"names":["Vue","mergeRecursive","DictMeta","DictData","DEFAULT_DICT_OPTIONS","types","Dict","owner","label","type","options","Array","opts","undefined","Error","ps","_dictMetas","map","t","parse","forEach","dictMeta","set","lazy","push","loadDict","Promise","all","find","e","reject","dict","request","then","response","dicts","responseConverter","console","error","filter","d","length","splice","Number","MAX_SAFE_INTEGER","value"],"mappings":"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","sourcesContent":["import Vue from 'vue'\nimport { mergeRecursive } from \"@/utils/ruoyi\";\nimport DictMeta from './DictMeta'\nimport DictData from './DictData'\n\nconst DEFAULT_DICT_OPTIONS = {\n  types: [],\n}\n\n/**\n * @classdesc 字典\n * @property {Object} label 标签对象，内部属性名为字典类型名称\n * @property {Object} dict 字段数组，内部属性名为字典类型名称\n * @property {Array.<DictMeta>} _dictMetas 字典元数据数组\n */\nexport default class Dict {\n  constructor() {\n    this.owner = null\n    this.label = {}\n    this.type = {}\n  }\n\n  init(options) {\n    if (options instanceof Array) {\n      options = { types: options }\n    }\n    const opts = mergeRecursive(DEFAULT_DICT_OPTIONS, options)\n    if (opts.types === undefined) {\n      throw new Error('need dict types')\n    }\n    const ps = []\n    this._dictMetas = opts.types.map(t => DictMeta.parse(t))\n    this._dictMetas.forEach(dictMeta => {\n      const type = dictMeta.type\n      Vue.set(this.label, type, {})\n      Vue.set(this.type, type, [])\n      if (dictMeta.lazy) {\n        return\n      }\n      ps.push(loadDict(this, dictMeta))\n    })\n    return Promise.all(ps)\n  }\n\n  /**\n   * 重新加载字典\n   * @param {String} type 字典类型\n   */\n  reloadDict(type) {\n    const dictMeta = this._dictMetas.find(e => e.type === type)\n    if (dictMeta === undefined) {\n      return Promise.reject(`the dict meta of ${type} was not found`)\n    }\n    return loadDict(this, dictMeta)\n  }\n}\n\n/**\n * 加载字典\n * @param {Dict} dict 字典\n * @param {DictMeta} dictMeta 字典元数据\n * @returns {Promise}\n */\nfunction loadDict(dict, dictMeta) {\n  return dictMeta.request(dictMeta)\n    .then(response => {\n      const type = dictMeta.type\n      let dicts = dictMeta.responseConverter(response, dictMeta)\n      if (!(dicts instanceof Array)) {\n        console.error('the return of responseConverter must be Array.<DictData>')\n        dicts = []\n      } else if (dicts.filter(d => d instanceof DictData).length !== dicts.length) {\n        console.error('the type of elements in dicts must be DictData')\n        dicts = []\n      }\n      dict.type[type].splice(0, Number.MAX_SAFE_INTEGER, ...dicts)\n      dicts.forEach(d => {\n        Vue.set(dict.label[type], d.value, d.label)\n      })\n      return dicts\n    })\n}\n"]}]}