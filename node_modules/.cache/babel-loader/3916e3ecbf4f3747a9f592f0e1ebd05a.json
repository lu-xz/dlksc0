{"remainingRequest":"C:\\Users\\陆小主\\Desktop\\dlkcw\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\陆小主\\Desktop\\dlkcw\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\陆小主\\Desktop\\dlkcw\\src\\permission.js","dependencies":[{"path":"C:\\Users\\陆小主\\Desktop\\dlkcw\\src\\permission.js","mtime":1765263860728},{"path":"C:\\Users\\陆小主\\Desktop\\dlkcw\\babel.config.js","mtime":1741570206490},{"path":"C:\\Users\\陆小主\\Desktop\\dlkcw\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741571479562},{"path":"C:\\Users\\陆小主\\Desktop\\dlkcw\\node_modules\\babel-loader\\lib\\index.js","mtime":1741571480837},{"path":"C:\\Users\\陆小主\\Desktop\\dlkcw\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1741571479931}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovVXNlcnMvXHU5NjQ2XHU1QzBGXHU0RTNCL0Rlc2t0b3AvZGxrY3cvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgcm91dGVyIGZyb20gIi4vcm91dGVyIjsKaW1wb3J0IHN0b3JlIGZyb20gIi4vc3RvcmUiOwppbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSAiZWxlbWVudC11aSI7CmltcG9ydCBOUHJvZ3Jlc3MgZnJvbSAibnByb2dyZXNzIjsKaW1wb3J0ICJucHJvZ3Jlc3MvbnByb2dyZXNzLmNzcyI7CmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSAiQC91dGlscy9hdXRoIjsKTlByb2dyZXNzLmNvbmZpZ3VyZSh7CiAgc2hvd1NwaW5uZXI6IGZhbHNlCn0pOwp2YXIgd2hpdGVMaXN0ID0gWyIvbG9naW4iLCAiL2Rsa3NjL2luZGV4IiwgIi9kbGtzYy94cSIsICIvZGxrc2MvZ2R0aiIsICIvZGxrc2MveWNzaiIsICIvZGxrc2MvYWJub3JtYWwiLCAiL2Rsa3NjL2NoYXJ0IiwgIi9kbGtzYy94c2Z4IiwgIi9kbGtzYy94c3NqcWQiXTsKcm91dGVyLmJlZm9yZUVhY2goZnVuY3Rpb24gKHRvLCBmcm9tLCBuZXh0KSB7CiAgTlByb2dyZXNzLnN0YXJ0KCk7CgogIGlmICh3aGl0ZUxpc3QuaW5kZXhPZih0by5wYXRoKSAhPT0gLTEpIHsKICAgIC8vIOWcqOWFjeeZu+W9leeZveWQjeWNle+8jOebtOaOpei/m+WFpQogICAgbmV4dCgpOwogIH0gZWxzZSBpZiAoZ2V0VG9rZW4oKSkgewogICAgaWYgKHN0b3JlLmdldHRlcnMucm9sZXMubGVuZ3RoID09PSAwKSB7CiAgICAgIC8vIOWIpOaWreW9k+WJjeeUqOaIt+aYr+WQpuW3suaLieWPluWujHVzZXJfaW5mb+S/oeaBrwogICAgICBzdG9yZS5kaXNwYXRjaCgiR2V0SW5mbyIpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHN0b3JlLmRpc3BhdGNoKCJHZW5lcmF0ZVJvdXRlcyIpLnRoZW4oZnVuY3Rpb24gKGFjY2Vzc1JvdXRlcykgewogICAgICAgICAgLy8g5qC55o2ucm9sZXPmnYPpmZDnlJ/miJDlj6/orr/pl67nmoTot6/nlLHooagKICAgICAgICAgIHJvdXRlci5hZGRSb3V0ZXMoYWNjZXNzUm91dGVzKTsgLy8g5Yqo5oCB5re75Yqg5Y+v6K6/6Zeu6Lev55Sx6KGoCgogICAgICAgICAgbmV4dChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRvKSwge30sIHsKICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZQogICAgICAgICAgfSkpOyAvLyBoYWNr5pa55rOVIOehruS/nWFkZFJvdXRlc+W3suWujOaIkAogICAgICAgIH0pOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgc3RvcmUuZGlzcGF0Y2goIkxvZ091dCIpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgTWVzc2FnZS5lcnJvcihlcnIpOwogICAgICAgICAgbmV4dCh7CiAgICAgICAgICAgIHBhdGg6ICIvbG9naW4iCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBuZXh0KCk7CiAgICB9CiAgfSBlbHNlIHsKICAgIG5leHQoIi9sb2dpbiIpOyAvLyDlkKbliJnlhajpg6jph43lrprlkJHliLDpppbpobUKICAgIC8vIG5leHQoJy9kbGtjdy9pbmRleCcpIC8vIOWQpuWImeWFqOmDqOmHjeWumuWQkeWIsOmmlumhtQogIH0KfSk7CnJvdXRlci5hZnRlckVhY2goZnVuY3Rpb24gKCkgewogIE5Qcm9ncmVzcy5kb25lKCk7Cn0pOw=="},{"version":3,"sources":["C:/Users/陆小主/Desktop/dlkcw/src/permission.js"],"names":["router","store","Message","NProgress","getToken","configure","showSpinner","whiteList","beforeEach","to","from","next","start","indexOf","path","getters","roles","length","dispatch","then","accessRoutes","addRoutes","replace","catch","err","error","afterEach","done"],"mappings":";AAAA,OAAOA,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,SAASC,OAAT,QAAwB,YAAxB;AACA,OAAOC,SAAP,MAAsB,WAAtB;AACA,OAAO,yBAAP;AACA,SAASC,QAAT,QAAyB,cAAzB;AAEAD,SAAS,CAACE,SAAV,CAAoB;AAAEC,EAAAA,WAAW,EAAE;AAAf,CAApB;AAEA,IAAMC,SAAS,GAAG,CAChB,QADgB,EAEhB,cAFgB,EAGhB,WAHgB,EAIhB,aAJgB,EAKhB,aALgB,EAMhB,iBANgB,EAOhB,cAPgB,EAQhB,aARgB,EASf,eATe,CAAlB;AAYAP,MAAM,CAACQ,UAAP,CAAkB,UAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAoB;AACpCR,EAAAA,SAAS,CAACS,KAAV;;AACA,MAAIL,SAAS,CAACM,OAAV,CAAkBJ,EAAE,CAACK,IAArB,MAA+B,CAAC,CAApC,EAAuC;AACrC;AACAH,IAAAA,IAAI;AACL,GAHD,MAGO,IAAIP,QAAQ,EAAZ,EAAgB;AACrB,QAAIH,KAAK,CAACc,OAAN,CAAcC,KAAd,CAAoBC,MAApB,KAA+B,CAAnC,EAAsC;AACpC;AACAhB,MAAAA,KAAK,CACFiB,QADH,CACY,SADZ,EAEGC,IAFH,CAEQ,YAAM;AACVlB,QAAAA,KAAK,CAACiB,QAAN,CAAe,gBAAf,EAAiCC,IAAjC,CAAsC,UAACC,YAAD,EAAkB;AACtD;AACApB,UAAAA,MAAM,CAACqB,SAAP,CAAiBD,YAAjB,EAFsD,CAEtB;;AAChCT,UAAAA,IAAI,iCAAMF,EAAN;AAAUa,YAAAA,OAAO,EAAE;AAAnB,aAAJ,CAHsD,CAGtB;AACjC,SAJD;AAKD,OARH,EASGC,KATH,CASS,UAACC,GAAD,EAAS;AACdvB,QAAAA,KAAK,CAACiB,QAAN,CAAe,QAAf,EAAyBC,IAAzB,CAA8B,YAAM;AAClCjB,UAAAA,OAAO,CAACuB,KAAR,CAAcD,GAAd;AACAb,UAAAA,IAAI,CAAC;AAAEG,YAAAA,IAAI,EAAE;AAAR,WAAD,CAAJ;AACD,SAHD;AAID,OAdH;AAeD,KAjBD,MAiBO;AACLH,MAAAA,IAAI;AACL;AACF,GArBM,MAqBA;AACLA,IAAAA,IAAI,CAAC,QAAD,CAAJ,CADK,CACW;AAChB;AACD;AACF,CA9BD;AAgCAX,MAAM,CAAC0B,SAAP,CAAiB,YAAM;AACrBvB,EAAAA,SAAS,CAACwB,IAAV;AACD,CAFD","sourcesContent":["import router from \"./router\";\nimport store from \"./store\";\nimport { Message } from \"element-ui\";\nimport NProgress from \"nprogress\";\nimport \"nprogress/nprogress.css\";\nimport { getToken } from \"@/utils/auth\";\n\nNProgress.configure({ showSpinner: false });\n\nconst whiteList = [\n  \"/login\",\n  \"/dlksc/index\",\n  \"/dlksc/xq\",\n  \"/dlksc/gdtj\",\n  \"/dlksc/ycsj\",\n  \"/dlksc/abnormal\",\n  \"/dlksc/chart\",\n  \"/dlksc/xsfx\",\n   \"/dlksc/xssjqd\",\n];\n\nrouter.beforeEach((to, from, next) => {\n  NProgress.start();\n  if (whiteList.indexOf(to.path) !== -1) {\n    // 在免登录白名单，直接进入\n    next();\n  } else if (getToken()) {\n    if (store.getters.roles.length === 0) {\n      // 判断当前用户是否已拉取完user_info信息\n      store\n        .dispatch(\"GetInfo\")\n        .then(() => {\n          store.dispatch(\"GenerateRoutes\").then((accessRoutes) => {\n            // 根据roles权限生成可访问的路由表\n            router.addRoutes(accessRoutes); // 动态添加可访问路由表\n            next({ ...to, replace: true }); // hack方法 确保addRoutes已完成\n          });\n        })\n        .catch((err) => {\n          store.dispatch(\"LogOut\").then(() => {\n            Message.error(err);\n            next({ path: \"/login\" });\n          });\n        });\n    } else {\n      next();\n    }\n  } else {\n    next(\"/login\"); // 否则全部重定向到首页\n    // next('/dlkcw/index') // 否则全部重定向到首页\n  }\n});\n\nrouter.afterEach(() => {\n  NProgress.done();\n});\n"]}]}