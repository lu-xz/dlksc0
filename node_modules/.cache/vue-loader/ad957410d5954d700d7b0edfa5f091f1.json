{"remainingRequest":"C:\\Users\\陆小主\\Desktop\\dlkcw\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\陆小主\\Desktop\\dlkcw\\src\\views\\dlksc\\chart.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\陆小主\\Desktop\\dlkcw\\src\\views\\dlksc\\chart.vue","mtime":1741570207238},{"path":"C:\\Users\\陆小主\\Desktop\\dlkcw\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741571479562},{"path":"C:\\Users\\陆小主\\Desktop\\dlkcw\\node_modules\\babel-loader\\lib\\index.js","mtime":1741571480837},{"path":"C:\\Users\\陆小主\\Desktop\\dlkcw\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741571479562},{"path":"C:\\Users\\陆小主\\Desktop\\dlkcw\\node_modules\\vue-loader\\lib\\index.js","mtime":1741571481108}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldEN3U2l0ZUxpc3QsIGdldEFsbERlYWxQb3dlckxpc3QsIGdldEFsbFBvd2VyTGlzdCwgZ2V0VG93bkxpc3QgfSBmcm9tICdAL2FwaS9kbGtjdy9pbmRleCc7CmltcG9ydCBQaW55aW5NYXRjaCBmcm9tICdwaW55aW4tbWF0Y2gnOwppbXBvcnQgUG93ZXJDaGFydCBmcm9tICIuL3Bvd2VyQ2hhcnQudnVlIjsKaW1wb3J0IERlYWxQb3dlckNoYXJ0IGZyb20gIi4vZGVhbFBvd2VyQ2hhcnQudnVlIjsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgICBQb3dlckNoYXJ0LCBEZWFsUG93ZXJDaGFydAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG1hcERhdGE6IFtdLAogICAgICBmaW5hbE1hcERhdGE6IFtdLAogICAgICBpbml0TWFwRGF0YTogcmVxdWlyZSgiQC9zdGF0aWMvanNvbi9jd1NpdGUuanNvbiIpLAogICAgICBpbml0RGVhbFBvd2VyTGlzdDogcmVxdWlyZSgiQC9zdGF0aWMvanNvbi9kZWFsUG93ZXJMaXN0Lmpzb24iKSwKICAgICAgaW5pdFBvd2VyTGlzdDogcmVxdWlyZSgiQC9zdGF0aWMvanNvbi9wb3dlci5qc29uIiksCiAgICAgIGNoYXJ0UGFyYW1zOnsKICAgICAgICBzaXRlTmFtZTogdW5kZWZpbmVkLAogICAgICAgIHRvd246IHVuZGVmaW5lZCwKICAgICAgfSwKICAgICAgdG93bkRhdGE6IHJlcXVpcmUoIkAvc3RhdGljL2pzb24vdG93bkRhdGEuanNvbiIpLAogICAgICB0b3duT3B0aW9uczpbXSwKICAgICAgaW5pdFRvd25PcHRpb25zOiBbXSwKICAgICAgd2FpdGluZzogbnVsbCwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIGhhc1Bvd2VyOiBmYWxzZSwKICAgICAgaGFzRGVhbFBvd2VyOiBmYWxzZQogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7fSwKICBtb3VudGVkKCkgewogICAgLy8g6Z2Z5oCB6aG16Z2i55u05o6l5Yqg6L29CiAgICBpZihKU09OLnBhcnNlKHByb2Nlc3MuZW52LlZVRV9BUFBfSVNfU1RBVElDKSl7CiAgICAgIHRoaXMuaW5pdE1hcERhdGEuZm9yRWFjaChpdGVtPT57CiAgICAgICAgIGl0ZW0uZGVhbFBvd2VyID0gdGhpcy5pbml0RGVhbFBvd2VyTGlzdC5maW5kKGQ9PiBpdGVtLmN1c3RObyA9PT0gZC5jdXN0Tm8pIHx8IHt4RGF0YTpbXSxkZWFsRGF0YTpbXSxwb3dlckRhdGE6W119CiAgICAgICAgIGl0ZW0ucG93ZXIgPSB0aGlzLmluaXRQb3dlckxpc3QuZmluZChkPT4gaXRlbS5jdXN0Tm8gPT09IGQuY3VzdE5vKSB8fCB7eERhdGE6W10seURhdGE6W119OwogICAgICB9KQogICAgICB0aGlzLmZpbmFsTWFwRGF0YSA9IHRoaXMuaW5pdE1hcERhdGE7CiAgICAgIHRoaXMubGF6eUxvYWQodGhpcy5maW5hbE1hcERhdGEpOwogICAgICB0aGlzLnRvd25PcHRpb25zID0gdGhpcy50b3duRGF0YS5tYXAoaXRlbT0+ewogICAgICAgICAgbGV0IGpzb24gPSB7dG93bjogaXRlbS50b3dufQogICAgICAgICAgcmV0dXJuIGpzb247CiAgICAgICAgfSk7CiAgICAgIHRoaXMuaW5pdFRvd25PcHRpb25zID0gT2JqZWN0LmFzc2lnbih0aGlzLnRvd25PcHRpb25zKTsKICAgIH1lbHNlewogICAgICBjb25zdCB3YWl0aW5nID0gdGhpcy4kbG9hZGluZyh7CiAgICAgICAgbG9jazogdHJ1ZSwKICAgICAgICB0ZXh0OiAn5pWw5o2u5Yqg6L295Lit77yM6K+356iN5ZCOJywKICAgICAgICBzcGlubmVyOiAnZWwtaWNvbi1sb2FkaW5nJywKICAgICAgICBiYWNrZ3JvdW5kOiAncmdiYSgwLDAsMCwgMC4xKScKICAgICAgfSk7CiAgICAgIHRoaXMuZ2V0TWFwRGF0YSgpOwogICAgICBnZXRUb3duTGlzdCgpLnRoZW4oKHJlcykgPT4gewogICAgICAgIHRoaXMudG93bk9wdGlvbnMgPSByZXMuZGF0YTsKICAgICAgICB0aGlzLmluaXRUb3duT3B0aW9ucyA9IE9iamVjdC5hc3NpZ24odGhpcy50b3duT3B0aW9ucyk7CiAgICAgIH0pCiAgICAgIGxldCB0aW1lciA9IHNldEludGVydmFsKCgpID0+IHsKICAgICAgICBpZih0aGlzLmhhc0RlYWxQb3dlciAmJiB0aGlzLmhhc1Bvd2VyKXsKICAgICAgICAgIHdhaXRpbmcuY2xvc2UoKTsKICAgICAgICAgIHRoaXMubGF6eUxvYWQodGhpcy5maW5hbE1hcERhdGEpOwogICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7CiAgICAgICAgfQogICAgICB9LDUwKQogICAgfQogICAgCiAgfSwKICBtZXRob2RzOiB7CiAgICBiYWNrKCl7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHtuYW1lOiAiSW5kZXgiLHBhcmFtczogeyBiYWNrOiB0cnVlIH19KTsKICAgIH0sCiAgICBnZXRNYXBEYXRhKCl7CiAgICAgIGdldEN3U2l0ZUxpc3QoKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgIGNvbnN0IHNpdGVMaXN0ID0gcmVzLmRhdGE7CiAgICAgICAgICBsZXQgbGlzdCA9IFtdCiAgICAgICAgICBzaXRlTGlzdC5mb3JFYWNoKGl0ZW09PnsKICAgICAgICAgICAgICBpdGVtLmRlYWxQb3dlciA9IHt4RGF0YTpbXSxkZWFsRGF0YTpbXSxwb3dlckRhdGE6W119OwogICAgICAgICAgICAgIGl0ZW0ucG93ZXIgPSB7eERhdGE6W10seURhdGE6W119OwogICAgICAgICAgICAgIGxldCBqc29uID0geyJwcm9wZXJ0aWVzIjp7ImFkY29kZSI6MzIwMzEyMDAwMSwidmFsdWUiOiIxIiwibGV2ZWwiOiJjb3VudHJ5IiwiY2VudGVyIjpbaXRlbS5sbmcsaXRlbS5sYXRdLCJuYW1lIjppdGVtLm5hdHVyYWxWaWxsYWdlLCJhZGRyZXNzIjppdGVtLnRvd24gKyBpdGVtLmFkbWluaXN0cmF0aXZlVmlsbGFnZSArIGl0ZW0ubmF0dXJhbFZpbGxhZ2UsImRlYWxOdW0iOml0ZW0uZGVhbE51bSwiY3VzdE5vIjppdGVtLmN1c3ROb30KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgbGlzdC5wdXNoKGpzb24pCiAgICAgICAgICB9KQogICAgICAgICAgY29uc29sZS5sb2cobGlzdCkKICAgICAgICAgIHRoaXMuZmluYWxNYXBEYXRhID0gc2l0ZUxpc3Q7CiAgICAgICAgICB0aGlzLmdldEFsbERlYWxQb3dlckxpc3QoKTsKICAgICAgICAgIHRoaXMuZ2V0QWxsUG93ZXJMaXN0KCk7CiAgICAgIH0pCiAgICB9LAogICAgZ2V0QWxsRGVhbFBvd2VyTGlzdCgpewogICAgICBnZXRBbGxEZWFsUG93ZXJMaXN0KCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgY29uc3QgaW5pdERlYWxQb3dlckxpc3QgPSByZXMuZGF0YTsKICAgICAgICB0aGlzLmZpbmFsTWFwRGF0YS5mb3JFYWNoKGl0ZW09PnsKICAgICAgICAgIGl0ZW0uZGVhbFBvd2VyID0gaW5pdERlYWxQb3dlckxpc3QuZmluZChkPT4gaXRlbS5jdXN0Tm8gPT09IGQuY3VzdE5vKSB8fCB7eERhdGE6W10sZGVhbERhdGE6W10scG93ZXJEYXRhOltdfTsKICAgICAgICB9KQogICAgICAgIHRoaXMuaGFzRGVhbFBvd2VyID0gdHJ1ZTsKICAgICAgfSkKICAgIH0sCiAgICBnZXRBbGxQb3dlckxpc3QoKXsKICAgICAgZ2V0QWxsUG93ZXJMaXN0KCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgY29uc3QgaW5pdFBvd2VyTGlzdCA9IHJlcy5kYXRhOwogICAgICAgIHRoaXMuZmluYWxNYXBEYXRhLmZvckVhY2goaXRlbT0+ewogICAgICAgICAgaXRlbS5wb3dlciA9IGluaXRQb3dlckxpc3QuZmluZChkPT4gaXRlbS5jdXN0Tm8gPT09IGQuY3VzdE5vKSB8fCB7eERhdGE6W10seURhdGE6W119OwogICAgICAgIH0pCiAgICAgICAgdGhpcy5oYXNQb3dlciA9IHRydWU7CiAgICAgIH0pCiAgICB9LAogICAgY2hhbmdUb3duKCl7CiAgICAgIHRoaXMudG93bk9wdGlvbnMgPSB0aGlzLmluaXRUb3duT3B0aW9uczsKICAgIH0sCiAgICBoYW5kbGVGaWx0ZXIodmFsKSB7CiAgICAgIC8vIOWvuee7keWumuaVsOaNrui1i+WAvAogICAgICBpZiAodmFsKSB7CiAgICAgICAgdGhpcy50b3duT3B0aW9ucyA9IHRoaXMuaW5pdFRvd25PcHRpb25zLmZpbHRlcigoaXRlbSkgPT4gewogICAgICAgICAgLy8g5aaC5p6c55u05o6l5YyF5ZCr6L6T5YWl5YC855u05o6l6L+U5ZuedHJ1ZQogICAgICAgICAgaWYgKGl0ZW0udG93bikgewogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgaXRlbS50b3duLnRvVXBwZXJDYXNlKCkuaW5kZXhPZih2YWwudG9VcHBlckNhc2UoKSkgIT0gLTEKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8g6L6T5YWl5YC85ou86Z+zZAogICAgICAgICAgICByZXR1cm4gUGlueWluTWF0Y2gubWF0Y2goaXRlbS50b3duLCB2YWwpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMudG93bk9wdGlvbnMgPSB0aGlzLmluaXRUb3duT3B0aW9uczsKICAgICAgfQogICAgfSwKICAgIC8qKiDmkJzntKLmjInpkq7mk43kvZwgKi8KICAgIGhhbmRsZVF1ZXJ5KCkgewogICAgICB0aGlzLm1hcERhdGEgPSBbXTsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgbGV0IGxpc3QgPSB0aGlzLmZpbmFsTWFwRGF0YS5maWx0ZXIoaXRlbT0+ewogICAgICAgICAgaWYoIXRoaXMuY2hhcnRQYXJhbXMuc2l0ZU5hbWUpewogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgICAgaXRlbS5zaXRlTmFtZSA9IGl0ZW0udG93biArIGl0ZW0uYWRtaW5pc3RyYXRpdmVWaWxsYWdlICsgaXRlbS5uYXR1cmFsVmlsbGFnZTsKICAgICAgICAgIHJldHVybiBpdGVtLnNpdGVOYW1lLmluZGV4T2YodGhpcy5jaGFydFBhcmFtcy5zaXRlTmFtZSkgPiAtMSB8fCBQaW55aW5NYXRjaC5tYXRjaChpdGVtLnNpdGVOYW1lLCB0aGlzLmNoYXJ0UGFyYW1zLnNpdGVOYW1lKTsKICAgICAgfSkKICAgICAgbGlzdCA9IGxpc3QuZmlsdGVyKGl0ZW09PnsKICAgICAgICAgIGlmKCF0aGlzLmNoYXJ0UGFyYW1zLnRvd24pewogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGl0ZW0udG93biA9PT0gdGhpcy5jaGFydFBhcmFtcy50b3duOwogICAgICB9KQogICAgICB0aGlzLmxhenlMb2FkKGxpc3QpOwogICAgfSwKICAgIGxhenlMb2FkKGxpc3QpewogICAgICBsZXQgY291bnQgPSAwOwogICAgICB0aGlzLmxvYWRpbmcgPSBsaXN0Lmxlbmd0aCA+IDA7CiAgICAgIGxpc3QuZm9yRWFjaChpdGVtPT57CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICBjb3VudCArKzsKICAgICAgICAgIHRoaXMubWFwRGF0YS5wdXNoKGl0ZW0pOwogICAgICAgICAgdGhpcy5sb2FkaW5nID0gY291bnQgPCBsaXN0Lmxlbmd0aDsKICAgICAgICB9LCA1MCk7CiAgICAgIH0pCiAgICB9CiAgfSwKfTsK"},{"version":3,"sources":["chart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"chart.vue","sourceRoot":"src/views/dlkcw","sourcesContent":["<template>\r\n    <div>\r\n      <el-row style=\"margin-top:25px;\">\r\n        <el-col :span=\"24\">\r\n          <el-form :model=\"chartParams\" ref=\"queryForm\" :inline=\"true\" label-width=\"88px\">\r\n            <div class=\"back\" @click=\"back\">返回</div>\r\n            <el-form-item label=\"镇\" prop=\"town\">\r\n                <el-select\r\n                v-model=\"chartParams.town\"\r\n                placeholder=\"全部\"\r\n                clearable\r\n                filterable\r\n                :filter-method=\"handleFilter\"\r\n                size=\"small\"\r\n                style=\"width: 180px\"\r\n                @change=\"changTown\"\r\n                >\r\n                <el-option\r\n                    v-for=\"dict in townOptions\"\r\n                    :key=\"dict.town\"\r\n                    :label=\"dict.town\"\r\n                    :value=\"dict.town\"\r\n                />\r\n                </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"站点名称\" prop=\"siteName\">\r\n              <el-input\r\n                v-model=\"chartParams.siteName\"\r\n                placeholder=\"请输入站点名称\"\r\n                clearable\r\n                size=\"small\"\r\n                style=\"width: 240px\"\r\n                @keyup.enter.native=\"handleQuery\"\r\n                />\r\n            </el-form-item>\r\n            <el-form-item>\r\n                <el-button type=\"primary\" icon=\"el-icon-search\" size=\"mini\" @click=\"handleQuery\" :disabled=\"loading\">搜索</el-button>\r\n            </el-form-item>\r\n        </el-form>\r\n        </el-col>\r\n      </el-row>\r\n      <div class=\"chartMain\">\r\n        <el-row v-for=\"(item,index) in mapData\" :key=\"index\">\r\n          <el-col :span=\"24\" style=\"padding: 20px 0\">\r\n              <el-row :gutter=\"20\">\r\n                <el-col :span=\"14\">\r\n                  <div class=\"yy\">\r\n                    <div class=\"title3\">{{ item.town + item.administrativeVillage + item.naturalVillage }} 日用电量曲线图</div>\r\n                    <PowerChart :id=\"'power'+ index\" :power=\"item.power\"></PowerChart>\r\n                  </div\r\n                ></el-col>\r\n                <el-col :span=\"10\">\r\n                  <div class=\"yy\">\r\n                    <div class=\"title3\">{{ item.town + item.administrativeVillage + item.naturalVillage }} 处理量、用电量统计图</div>\r\n                    <DealPowerChart :id=\"'dealPower'+ index\" :dealPower=\"item.dealPower\"></DealPowerChart>\r\n                  </div\r\n                ></el-col> </el-row\r\n            ></el-col>\r\n        </el-row>\r\n      </div>\r\n    </div>\r\n  </template>\r\n  <script>\r\n  import { getCwSiteList, getAllDealPowerList, getAllPowerList, getTownList } from '@/api/dlkcw/index';\r\n  import PinyinMatch from 'pinyin-match';\r\n  import PowerChart from \"./powerChart.vue\";\r\n  import DealPowerChart from \"./dealPowerChart.vue\";\r\n  export default {\r\n    components: {\r\n       PowerChart, DealPowerChart\r\n    },\r\n    data() {\r\n      return {\r\n        mapData: [],\r\n        finalMapData: [],\r\n        initMapData: require(\"@/static/json/cwSite.json\"),\r\n        initDealPowerList: require(\"@/static/json/dealPowerList.json\"),\r\n        initPowerList: require(\"@/static/json/power.json\"),\r\n        chartParams:{\r\n          siteName: undefined,\r\n          town: undefined,\r\n        },\r\n        townData: require(\"@/static/json/townData.json\"),\r\n        townOptions:[],\r\n        initTownOptions: [],\r\n        waiting: null,\r\n        loading: false,\r\n        hasPower: false,\r\n        hasDealPower: false\r\n      };\r\n    },\r\n    created() {},\r\n    mounted() {\r\n      // 静态页面直接加载\r\n      if(JSON.parse(process.env.VUE_APP_IS_STATIC)){\r\n        this.initMapData.forEach(item=>{\r\n           item.dealPower = this.initDealPowerList.find(d=> item.custNo === d.custNo) || {xData:[],dealData:[],powerData:[]}\r\n           item.power = this.initPowerList.find(d=> item.custNo === d.custNo) || {xData:[],yData:[]};\r\n        })\r\n        this.finalMapData = this.initMapData;\r\n        this.lazyLoad(this.finalMapData);\r\n        this.townOptions = this.townData.map(item=>{\r\n            let json = {town: item.town}\r\n            return json;\r\n          });\r\n        this.initTownOptions = Object.assign(this.townOptions);\r\n      }else{\r\n        const waiting = this.$loading({\r\n          lock: true,\r\n          text: '数据加载中，请稍后',\r\n          spinner: 'el-icon-loading',\r\n          background: 'rgba(0,0,0, 0.1)'\r\n        });\r\n        this.getMapData();\r\n        getTownList().then((res) => {\r\n          this.townOptions = res.data;\r\n          this.initTownOptions = Object.assign(this.townOptions);\r\n        })\r\n        let timer = setInterval(() => {\r\n          if(this.hasDealPower && this.hasPower){\r\n            waiting.close();\r\n            this.lazyLoad(this.finalMapData);\r\n            clearInterval(timer);\r\n          }\r\n        },50)\r\n      }\r\n      \r\n    },\r\n    methods: {\r\n      back(){\r\n        this.$router.push({name: \"Index\",params: { back: true }});\r\n      },\r\n      getMapData(){\r\n        getCwSiteList().then((res) => {\r\n            const siteList = res.data;\r\n            let list = []\r\n            siteList.forEach(item=>{\r\n                item.dealPower = {xData:[],dealData:[],powerData:[]};\r\n                item.power = {xData:[],yData:[]};\r\n                let json = {\"properties\":{\"adcode\":3203120001,\"value\":\"1\",\"level\":\"country\",\"center\":[item.lng,item.lat],\"name\":item.naturalVillage,\"address\":item.town + item.administrativeVillage + item.naturalVillage,\"dealNum\":item.dealNum,\"custNo\":item.custNo}\r\n                }\r\n                list.push(json)\r\n            })\r\n            console.log(list)\r\n            this.finalMapData = siteList;\r\n            this.getAllDealPowerList();\r\n            this.getAllPowerList();\r\n        })\r\n      },\r\n      getAllDealPowerList(){\r\n        getAllDealPowerList().then((res) => {\r\n          const initDealPowerList = res.data;\r\n          this.finalMapData.forEach(item=>{\r\n            item.dealPower = initDealPowerList.find(d=> item.custNo === d.custNo) || {xData:[],dealData:[],powerData:[]};\r\n          })\r\n          this.hasDealPower = true;\r\n        })\r\n      },\r\n      getAllPowerList(){\r\n        getAllPowerList().then((res) => {\r\n          const initPowerList = res.data;\r\n          this.finalMapData.forEach(item=>{\r\n            item.power = initPowerList.find(d=> item.custNo === d.custNo) || {xData:[],yData:[]};\r\n          })\r\n          this.hasPower = true;\r\n        })\r\n      },\r\n      changTown(){\r\n        this.townOptions = this.initTownOptions;\r\n      },\r\n      handleFilter(val) {\r\n        // 对绑定数据赋值\r\n        if (val) {\r\n          this.townOptions = this.initTownOptions.filter((item) => {\r\n            // 如果直接包含输入值直接返回true\r\n            if (item.town) {\r\n              if (\r\n                item.town.toUpperCase().indexOf(val.toUpperCase()) != -1\r\n              ) {\r\n                return true;\r\n              }\r\n              // 输入值拼音d\r\n              return PinyinMatch.match(item.town, val);\r\n            }\r\n          });\r\n        } else {\r\n          this.townOptions = this.initTownOptions;\r\n        }\r\n      },\r\n      /** 搜索按钮操作 */\r\n      handleQuery() {\r\n        this.mapData = [];\r\n        this.loading = true;\r\n        let list = this.finalMapData.filter(item=>{\r\n            if(!this.chartParams.siteName){\r\n                return true;\r\n            }\r\n            item.siteName = item.town + item.administrativeVillage + item.naturalVillage;\r\n            return item.siteName.indexOf(this.chartParams.siteName) > -1 || PinyinMatch.match(item.siteName, this.chartParams.siteName);\r\n        })\r\n        list = list.filter(item=>{\r\n            if(!this.chartParams.town){\r\n                return true;\r\n            }\r\n            return item.town === this.chartParams.town;\r\n        })\r\n        this.lazyLoad(list);\r\n      },\r\n      lazyLoad(list){\r\n        let count = 0;\r\n        this.loading = list.length > 0;\r\n        list.forEach(item=>{\r\n          setTimeout(() => {\r\n            count ++;\r\n            this.mapData.push(item);\r\n            this.loading = count < list.length;\r\n          }, 50);\r\n        })\r\n      }\r\n    },\r\n  };\r\n  </script>\r\n  \r\n  <style lang=\"scss\" scoped>\r\n  @import \"./style.scss\";\r\n  </style>"]}]}